$client = New-Object System.Net.WebClient
$client.DownloadFile("http://www.indiewire.com/wp-content/uploads/2017/07/rick-and-morty.png" , "$home\rick-and-morty.png")
Set-ItemProperty -path 'HKCU:\Control Panel\Desktop\' -name wallpaper -value "$home\rick-and-morty.png"
Set-ItemProperty -path 'HKCU:\Software\Microsoft\Internet Explorer\Desktop\General' -name wallpaper -value "$home\rick-and-morty.png"
rundll32.exe user32.dll, UpdatePerUserSystemParameters
rundll32.exe user32.dll, UpdatePerUserSystemParameters 1, True


class Program
 {
  [DllImport("user32.dll", SetLastError = true)]
  private static extern IntPtr SendMessageTimeout ( IntPtr hWnd, int Msg, IntPtr wParam, string lParam, uint fuFlags, uint uTimeout, IntPtr lpdwResult );
  private static readonly IntPtr HWND_BROADCAST = new IntPtr(0xffff);
  private const int WM_SETTINGCHANGE = 0x1a;
  private const int SMTO_ABORTIFHUNG = 0x0002;
  static void Main ( string[] args )
  {
   SendMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, IntPtr.Zero, null, SMTO_ABORTIFHUNG, 100, IntPtr.Zero);
  }
 }
